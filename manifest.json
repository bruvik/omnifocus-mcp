{
  "schema_version": "1.0",
  "name": "omnifocus-mcp",
  "version": "0.1.0",
  "description": "MCP server that surfaces OmniFocus tasks via FastAPI using AppleScript.",
  "server": {
    "command": "python",
    "args": ["server.py"]
  },
  "tools": [
    {
      "name": "list_tasks",
      "description": "List all OmniFocus tasks with project, due, flagged, completed, and note fields.",
      "input_schema": {
        "type": "object",
        "properties": {
          "filter": {
            "type": "string",
            "enum": ["due_soon", "flagged", "inbox"],
            "description": "Optional filter for tasks: due_soon (tasks due within 24 hours), flagged (flagged tasks only), or inbox (inbox tasks only)."
          }
        },
        "required": []
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "tasks": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": { "type": "string", "description": "Task title." },
                "id": { "type": "string", "description": "OmniFocus task identifier." },
                "project": { "type": "string", "description": "Containing project name (empty if none)." },
                "due": { "type": "string", "description": "Due date as ISO string, empty if none." },
                "flagged": { "type": "boolean", "description": "Whether the task is flagged." },
                "completed": { "type": "boolean", "description": "Whether the task is completed." },
                "note": { "type": "string", "description": "Task note text (may be empty)." }
              },
              "required": ["name", "id", "project", "due", "flagged", "completed", "note"]
            }
          }
        },
        "required": ["tasks"]
      }
    },
    {
      "name": "add_task",
      "description": "Create a new OmniFocus task, optionally assigning it to a project; defaults to the inbox.",
      "input_schema": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "description": "Title of the task to create."
          },
          "project": {
            "type": "string",
            "description": "Optional project name to place the task under; if omitted, task is added to the inbox."
          }
        },
        "required": ["title"]
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "status": { "type": "string", "enum": ["ok"], "description": "Indicates the task was created successfully." },
          "output": { "type": "string", "description": "Raw JSON string returned by the AppleScript describing the created task." }
        },
        "required": ["status", "output"]
      }
    },
    {
      "name": "complete_task",
      "description": "Mark an OmniFocus task as completed by its identifier.",
      "input_schema": {
        "type": "object",
        "properties": {
          "task_id": { "type": "string", "description": "OmniFocus task identifier to complete." }
        },
        "required": ["task_id"]
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "status": { "type": "string", "enum": ["ok"], "description": "Indicates the task was completed successfully." },
          "id": { "type": "string", "description": "Identifier of the completed task." },
          "name": { "type": "string", "description": "Name of the completed task." },
          "error": { "type": "string", "description": "Error message if the completion failed." }
        },
        "required": ["status"]
      }
    },
    {
      "name": "summarize_tasks",
      "description": "Summarize OmniFocus tasks by project and status.",
      "input_schema": {
        "type": "object",
        "properties": {},
        "required": []
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "projects": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "project": { "type": "string", "description": "Project name (empty for inbox/unassigned)." },
                "active": { "type": "integer", "description": "Count of active tasks (not completed)." },
                "flagged": { "type": "integer", "description": "Count of flagged tasks." },
                "due_today": { "type": "integer", "description": "Count of tasks due today." },
                "overdue": { "type": "integer", "description": "Count of tasks overdue." }
              },
              "required": ["project", "active", "flagged", "due_today", "overdue"]
            }
          }
        },
        "required": ["projects"]
      }
    },
    {
      "name": "get_projects",
      "description": "Retrieve all OmniFocus projects with their names and identifiers.",
      "input_schema": {
        "type": "object",
        "properties": {},
        "required": []
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "projects": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "description": "OmniFocus project identifier." },
                "name": { "type": "string", "description": "Project name." }
              },
              "required": ["id", "name"]
            }
          }
        },
        "required": ["projects"]
      }
    }
  ]
}
